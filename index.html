<html>
    <head>
        <meta charset="utf-8">
	<style>
	#box { width: 300px; height: 200px; }
	.lines { border: 3px solid #000; }
	</style>
	<script src="src/script-min.js?array,object,element,event,socket"></script>
    </head>
    <body>
        <div id="box">BOX</div>
	<script>
            window.onload = function() {
                // wrap namespace in variable
	        var jsc = JSHELPING.Core;
		
                var modArray = jsc.getModule('array');			
		
		var myArr = [1,2,3];
                console.log( modArray.isArray(myArr) );
		console.log( modArray.isArray(true) );
		modArray.each(myArr, function add(x){return x+=10;});		        
		console.log(myArr);         
				
		var modElement = jsc.getModule('element');
		modElement.add('box', 'output');
		modElement.addClass(document.querySelector('#box'), 'lines');
				
		setTimeout(function() {
		    modElement.removeClass(document.querySelector('#box'), 'lines');
		}, 2000);
				
		setTimeout(function() {
		    modElement.addClass(document.querySelector('#box'), 'lines');
		}, 4000);
			
                // create a module	
		function myModule() {
                    return {
		        doWork: function() {
		            return 'done';
		        }
	            }
                }
		jsc.register('myModule', myModule);
                var myMod = jsc.getModule('myModule');
                console.log(myMod.doWork()); 
		
		var modObject = jsc.getModule('object');
		
                function A() {
                    this.name = 'A';
                }
                A.prototype.sayA = function sayA() {
                    return 'sayA ' + this.name;
                }

                function B() {
                    //this.name = 'B'; // overwrite this.name
                }
	
                modObject.extend(B, A);

                B.prototype.sayB = function sayB() {
                    return 'sayB ' + this.name;
                }

                var b = new B();

                console.log( b.name ); // A
                console.log( b.sayA() ); // sayA A
                console.log( b.sayB() ); // sayB A
		
                var c = modObject.clone(B);		
                console.log( b.sayB() ); // A				
		
		var modSocket = jsc.getModule('socket');
		
                function myHandler(data) {
		    document.querySelector('#output').innerHTML = data.time;
		    //modSocket.send('echo', {'msg':'update'});
		}
                
		var handlings = [
		    {'name':'msg', 'func': function(data){console.log(data.message);}},
		    {'name':'update', 'func': myHandler}
		];
		
                modSocket.connect('http://localhost:3000', handlings);
		
                modSocket.send('echo', {'msg':'test1'});
		modSocket.send('echo', {'msg':'test2'});
	    }
	</script>
    </body>
</html>
