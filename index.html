<html>
    <head>
        <meta charset="utf-8">
	<style>
	#box { width: 100px; height: 50px; }
	.lines { border: 3px solid #000; }
	</style>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<script src="src/script-min.js?array,object,element,event,form,socket"></script>
    </head>
    <body>
	    <div class="container">
		    <h1>js-helping</h1>            
			<form id="loginFrm" class="form-horizontal" action="/login" method="post">
                    <fieldset>
                        <legend>Loginform</legend>
                        <div class="control-group"><input type="email" class="span3" id="email" value="" placeholder="email@web.de" pattern="^([0-9a-zA-Z]+([_.-]?[0-9a-zA-Z]+)*@[0-9a-zA-Z]+[0-9,a-z,A-Z,.,-]*(.){1}[a-zA-Z]{2,4})+$"></div>
                        <div class="control-group"><input type="password" name="password" class="span3" placeholder="password"></div>
                        <div class="control-group"><button type="submit" class="btn btn-primary">Login</button> <span id="frmMsg"></span></div>
                    </fieldset>
            </form> 
			<div id="box">BOX</div>
		</div>
	<script>
            window.onload = function() {
                // wrap namespace in variable
	        var jsc = JSHELPING.Core;
		
                var modArray = jsc.getModule('array');			
		
		var myArr = [1,2,3];
                console.log( modArray.isArray(myArr) );
		console.log( modArray.isArray(true) );
		modArray.each(myArr, function add(x){return x+=10;});		        
		console.log(myArr);         
				
		var modElement = jsc.getModule('element');
		modElement.add('box', 'output');
		modElement.addClass(document.querySelector('#box'), 'lines');
				
		setTimeout(function() {
		    modElement.removeClass(document.querySelector('#box'), 'lines');
		}, 2000);
				
		setTimeout(function() {
		    modElement.addClass(document.querySelector('#box'), 'lines');
		}, 4000);
		
		var modEvent = jsc.getModule('event'); 
		modEvent.add(document.querySelector('#loginFrm'), 'submit', function(e) {
		    e.preventDefault();
			var modForm = jsc.getModule('form');
			//return sendForm('loginFrm');
			document.querySelector('#frmMsg').innerHTML = JSON.stringify(modForm.validate('loginFrm'));
			return false;
		});
			
                // create a module	
		function myModule() {
                    return {
		        doWork: function() {
		            return 'done';
		        }
	            }
                }
		jsc.register('myModule', myModule);
                var myMod = jsc.getModule('myModule');
                console.log(myMod.doWork()); 
		
		var modObject = jsc.getModule('object');
		
                function A() {
                    this.name = 'A';
                }
                A.prototype.sayA = function sayA() {
                    return 'sayA ' + this.name;
                }

                function B() {
                    //this.name = 'B'; // overwrite this.name
                }
	
                modObject.extend(B, A);

                B.prototype.sayB = function sayB() {
                    return 'sayB ' + this.name;
                }

                var b = new B();

                console.log( b.name ); // A
                console.log( b.sayA() ); // sayA A
                console.log( b.sayB() ); // sayB A
		
                var c = modObject.clone(B);		
                console.log( b.sayB() ); // A				
		
		var modSocket = jsc.getModule('socket');
		
                function myHandler(data) {
		    document.querySelector('#output').innerHTML = data.time;
		    //modSocket.send('echo', {'msg':'update'});
		}
                
		var handlings = [
		    {'name':'msg', 'func': function(data){console.log(data.message);}},
		    {'name':'update', 'func': myHandler}
		];
		
                modSocket.connect('http://localhost:3000', handlings);
		
                modSocket.send('echo', {'msg':'test1'});
		modSocket.send('echo', {'msg':'test2'});
	    }
	</script>
    </body>
</html>
